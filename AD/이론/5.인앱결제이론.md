
# 인앱 결제

출처 : 안드로이드 developer 공식홈페이지

https://developer.android.com/google/play/billing/billing_overview.html?hl=ko

## 1.Google Play 결제 개요.


GooglePlay 결제는 Android에서 디지털 콘텐츠를 판매할 수 있게 해주는 서비스이다.



## 2.Google Play 결제 솔루션의 구성요소 목록.


* 2.1 Google Play.

사용자가 디지털 제품을 다운로드할 수 있는 온라인 상점이다.


* 2.2Google Play Console.

앱 개발자가 Google Play에 앱을 게시하는 데 사용하는 인터페이스이다.

앱 개발자는 Google Play Console을 사용하여 인앱 상품을 포함한 앱의

세부 정보를 확인한다.

참조 : https://developer.android.com/distribute/console/index.html?hl=ko



* 2.3 Google API Console

Google Play Developer 와 같은 백엔드 API를 관리하기 위한 콘솔이다.

보안 백엔드 서버에서 구매와 정기 결제를 확인하려면

여기서 서비스 계정을 만들어야 한다.

참조 : https://console.developers.google.com/?hl=ko


* 2.4 Android 기기.

태블릿이나 휴대전화와 같이 Android 앱을 싱행하는 데 사용되는 모든 기기이다.


* 2.5 Android 앱

Android 기기에서 실행되도록 만든 애플리케이션이다.


* 2.6 보안 백앤드 서버.

실시간 개발자 알림과 같은 구매 확인 또는 정기 결제 기능을 구현하는 데 사용되는 개발자 제공 서버이다.


* 2.7 Play 스토어 앱.

Google Play 결제와 관련된 모든 작업을 관리하는 앱이다.

앱의 모든 요청은 Play 스토어 앱에서 처리함.


* 2.8 Google Play 결제 라이브러리.

개발자가 앱에서 Google Play 결제를 구현하는데 사용하는 API이다.

참조 : https://developer.android.com/google/play/billing/billing_library_overview?hl=ko


* 2.9 Google Play Developer API.

프로그래밍 방식으로 여러 게시 및 앱 관리 작업을 진행하는데 사용되는 REST API이다.

여기에는 구매 및 정기 결제를 관리하는데 사용되는 정기 결제 및 GOOGLE PLAY결제

API와 앱 및 기타 게시 관련 작업을 업로드하고 게시하는 게시API라는 2개의 구성요소가 포함되어있다.


참조 : https://developers.google.com/android-publisher/

이건 한글로 번역된게 없는듯.

정기 결제 및 구글플레이 결제 API : https://developers.google.com/android-publisher/?hl=ko#subscriptions

게시 API : https://developers.google.com/android-publisher/?hl=ko#publishing

* 2.10 실시간 개발자 알림

Play에서 관리하는 정기 결제와 관련된,

SUBSCRIPTION_PURCHASED 또는

SUBSCRIPTION_RECOVERED 와 같은 상태 변화를

모니터링 할 수 있는 서버 푸시 알림이다.

참조 : https://developer.android.com/google/play/billing/realtime_developer_notifications?hl=ko



## 3. 인앱 상품 유형


* 3.1 일회성 제품

사용자의 결제 방법으로 반복되지 않는 단일 청구를 요구하는 인앱 상품이다.

일회성 제품의 예로는 추가 게임 레벨, 프리미엄 전리품 상자, 미디어 파일 등.

Google Play Console 에서는 일회성 제품을 관리되는 제품이라고 하고,

Google Play 결제 라이브러리에서 'INAPP'이라고 한다.


* 3.2 리워드 제품

사용자에게 동영상 광고 시청을 요구하는 인앱 상품이다.

리워드 제품의 예로는 추가 생명,게임 내 통화, 기한이 있는 작업의 신속한 완료가 있다.

Google Play Consol에서는 리워드 제품을 리워드 제품이라고 하고,

Google Play 결제 라이브러리에서는 'INAPP'이라고 합니다.


* 3.3 정기 결제

사용자의 결제 방법으로 반복되는 청구를 요구하는 인앱 상품이다.

정기 결제의 예로는 온라인 잡지 및 음악 스트리밍 서비스가 있다.

Google Play 결제 라이브러리에서는 이를 'SUBS'라고 한다.



## 4. 구매 토큰 및 주문 ID


Google Play 결제에서는 구매 토큰과 주문 ID를 사용하여 제품 및 거래를 추적한다.


* 4.1

구매 토큰은 Google Play에서 제품에 대한 구매자의 자격을 나타내는 문자열이다.

또한 Google 사용자가 SKU로 표시되는 특정 제품의 비용을 지불했음을 나타낸다.


* 4.2

주문 ID 는 Google Play에서 금융 거래를 나태는 문자열입니다.

이 문자열은 구매자에게 이메일로 전송되는 영수증 포함되며, 타사 개발자는

Google Play Console의 주문 관리 섹션에서 주문 ID를 사용하여 환불을 관리한다.

판매 및 판매 대금 보고서에도 주문 ID가 사용된다.


* 4.3

일회성 및 리워드 제품의 경우 구매할 때마다 새 토큰과 새 주문 ID가 생성


* 4.4

정기 결제의 경우 초기 구매시 토큰과 주문ID가 생성된다.

그 이후 결제 기간마다 구매 토큰은 그대로 유지되고 새 주문 ID가 발급된다.

업그레이드,다운그레이드,재가입시 모두 새로운 구매 토큰과 주문 ID가 생성된다.



## 5. 인앱 상품 구성 옵션


일회성 제품 및 정기 결제의 경우 Google Play Console에서 구성할 수 있는

몇 가지 공통된 옵션이 있다.

이중 가장 중요한 구성 옵션은 다음과 같다.


제목 - 인앱 상품에 대한 간단한 설명(예: '전리품 상자').


설명 - 인앱 상품에 대한 더 긴 설명 (예: '캐릭터에 유용한 아이템이 들어 있는 게임 내 특별 보물 상자').

앱의 스토어 등록정보 페이지에서 인앱 상품을 설명하는 데 이 필드를 사용할 수 있습니다.


제품 ID - 사람이 읽을 수 있는 고유한 제품의 ID.

Google Play 결제 라이브러리에서는 제품 ID를 SKU라고도 합니다.


가격/기본 가격 - 사용자가 인앱 상품을 결제할 금액.

기본 가격은 인앱 상품의 유형에 따라 의미가 약간씩 달라진다.


일회성 제품의 기본 가격은 제품을 구매한 사용자에게 청구할 금액(사용자의 기본 통화로 표시)을 반영한다.

일회성 제품을 구매할 때마다 고객에게 기본 가격이 한 번 청구한다.


리워드 구매에는 가격이나 기본 가격이 없다.

특히 이 옵션의 값은 사용자가 보는 광고의 값을 나타내지 않는다.


정기 결제의 기본 가격은 일반 결제 주기가 시작된 후 사용자의 기본 통화로 청구되는 가격입니다(정기 결제에는 무료 체험판 및 신규 할인 가격이 포함될 수 있음).

사용자가 구매한 정기 결제마다 기본 가격이 반복적으로 고객에게 청구됩니다

.

단일 앱을 구매할 때 제품 ID와 가격이 각기 다른 여러 개의 인앱 상품이 포함될 수 있다.

Google Play Console에서는 동일한 가격을 공유하는 여러 인앱 상품을 쉽게 구성하는 데 사용되는 가격 템플릿을 제공.


## 6. 고유한 정기 결제 제품 구성 옵션

Google Play Conslo을 사용하면 매우 유연하게 정기 결제 제품을 만들 수 있다.

다음은 정기 결제 제품에 사용할 수 있는 옵션 목록이다.


* 6.1 결제 기간

정기 결제가 활성화 되어 있는 동안 사용자에게 청구되는 빈도.

Google Play Console에서 매주,매월,3개월,6개월 및 연간 결제 기간 중에서 선택할 수 있다.

정기 결제에 지정된 간격 및 가격으로 결제가 무기한 계속된다.

정기 결제가 갱신될 때마다 Google Play에서 사용자 게정에 자동으로 청구한 후

이메일로 사용자에게 청구 내역을 알려줌.


* 6.2 무료 체험판 기간

사용자가 결제하지 않고 정기 결제에 액세스할 수 있는 기간이다.

무료 체험판 기간은 사용자가 구매를 결정하기 전에 정기 결제하도록 유도하는 방법이다.


* 6.3 신규 할인 가격

초기의 '신규 할인' 결제 기간에 적용되는 정기 결제 가격이다.

신규 할인 가격은 사용자에게 정기 결제하도록 유도하는 동시에 약간의 수익을 얻는 방법이다.

신규할인 가격은 정상 정기 결제 가격보다 낮아야 한다.


* 6.4 유예기간

사용자가 결제 문제를 해결하도록 추가로 시간을 주어 사용자의 정기 결제가 활성 상태로

유지되는 기간이다.

신용카드와 같은 사용자 결제 방법이 거부되면 유예 기간이 시작된다.


* 6.5 계정 보류

유예 기간에 사용자가 결제 방법을 업데이트하지 않을 경우 전환될 수 있는 정기 결제 상태이다.

계정 보류는 30일간 지속되며, 이기간에는

사용자가 정기 결제 콘텐츠를 이용할 수 없다.


참조 : 정기결제 만들기 https://support.google.com/googleplay/android-developer/answer/140504?hl=ko




끝.
